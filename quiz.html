<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>IP Quizzes - IDEA VAULT CLUB</title>
<link rel="stylesheet" href="css/style.css">
</head>
<body>

<nav class="navbar">
    <img src="images/logo.png" class="logo-nav">
    <ul class="nav-links">
        <li><a href="index.html">Home</a></li>
        <li><a href="courses.html">Courses</a></li>
        <li><a href="leaderboard.html">Leaderboard</a></li>
        <li><a href="profile.html">Profile</a></li>
    </ul>
</nav>

<main>

<section class="hero">
    <h1>IP Knowledge Quizzes</h1>
    <p>Select your Intellectual Property area</p>
</section>

<!-- Quiz Category -->
<section class="quiz-select">
    <select id="quizCategory">
        <option value="">Choose Quiz Area</option>
        <option value="patent">Patent</option>
        <option value="trademark">Trademark</option>
        <option value="copyright">Copyright</option>
    </select>
    <button onclick="loadQuiz()">Start Quiz</button>
</section>

<section id="quizSection" style="display:none;">
    <h2 id="quizTitle"></h2>
    <div id="quizContainer"></div>
    <button onclick="submitQuiz()">Submit Quiz</button>
</section>

<section id="resultSection" style="display:none;">
    <h2>Your Score</h2>
    <p id="scoreText"></p>
    <div id="corrections"></div>
    <button onclick="generateCertificate()">Download Certificate</button>
</section>

</main>

<script>

const quizData = {
patent: [
{q:"What does a patent protect?", options:["Brand","Invention","Music","Design"], answer:1},
{q:"Patent validity lasts how long?", options:["5 yrs","10 yrs","20 yrs","Forever"], answer:2}
],
trademark: [
{q:"Trademark protects?", options:["Invention","Logo","Song","Recipe"], answer:1},
{q:"Trademark applies to?", options:["Brand name","Land","Building","Machine"], answer:0}
],
copyright: [
{q:"Copyright protects?", options:["Books","Machines","Ideas","Factories"], answer:0},
{q:"Copyright applies to?", options:["Music","Invention","Logo","Medicine"], answer:0}
]
};

let selectedQuiz = [];
let userAnswers = [];

function loadQuiz(){
let category = document.getElementById("quizCategory").value;
if(!category) return alert("Select quiz first");

selectedQuiz = quizData[category];
document.getElementById("quizTitle").innerText = category.toUpperCase() + " QUIZ";

let container = document.getElementById("quizContainer");
container.innerHTML="";
userAnswers=[];

selectedQuiz.forEach((q,index)=>{
let div = document.createElement("div");
div.innerHTML = `<h3>${q.q}</h3>` +
q.options.map((opt,i)=>
`<label><input type="radio" name="q${index}" value="${i}">${opt}</label><br>`
).join("");
container.appendChild(div);
});

document.getElementById("quizSection").style.display="block";
}

function submitQuiz(){
let score = 0;
let correctionHTML="";

selectedQuiz.forEach((q,i)=>{
let selected = document.querySelector(`input[name="q${i}"]:checked`);
let answer = selected ? parseInt(selected.value) : -1;
userAnswers.push(answer);

if(answer === q.answer){
score++;
}else{
correctionHTML += `
<p>
‚ùå ${q.q}<br>
Your answer: ${q.options[answer] || "None"}<br>
Correct answer: ${q.options[q.answer]}
</p>`;
}
});

let percent = (score/selectedQuiz.length)*100;

document.getElementById("scoreText").innerText =
`You scored ${score}/${selectedQuiz.length} (${percent}%)`;

document.getElementById("corrections").innerHTML = correctionHTML;
document.getElementById("resultSection").style.display="block";

// Save marks
let currentUser = JSON.parse(localStorage.getItem('ivc_current_user'));
currentUser.score = percent;
localStorage.setItem('ivc_current_user', JSON.stringify(currentUser));
}

function generateCertificate(){
let user = JSON.parse(localStorage.getItem('ivc_current_user'));

let certWindow = window.open("", "_blank");
certWindow.document.write(`
<h1>IDEA VAULT CLUB</h1>
<h2>Certificate of Achievement</h2>
<p>This certifies that</p>
<h2>${user.name}</h2>
<p>has successfully completed an IP Quiz</p>
<p>Score: ${user.score}%</p>
<p>Date: ${new Date().toLocaleDateString()}</p>
`);
}

</script>

<style>
.hero{text-align:center;padding:2rem;background:#007bff;color:white}
.quiz-select{text-align:center;margin:1rem}
#quizContainer{padding:1rem}
#quizContainer div{background:#fff;margin:1rem;padding:1rem;border-radius:8px}
</style>

</body>
</html>
